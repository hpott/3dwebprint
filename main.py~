from flask import Flask, render_template, request, send_from_directory
import os
app = Flask(__name__)
@app.route('/')
def homepage():
   return render_template('index.html')

@app.route('/print')
def upload():
   return render_template('upload.html')
	
@app.route('/uploader', methods = ['GET', 'POST'])
def upload_file():
   if request.method == 'POST':
      f = request.files['file']
      if '.stl' in f.filename:
         f.save('uploads/'+f.filename)
         return 'file uploaded successfully. <a href=/upload>go back</a> or <a href=/files>list files</a>'
      else:
         return 'not an STL file. try again. <a href=/upload>go back</a>'

@app.route('/files')
def list_files():
   list = os.listdir('uploads/')
   return render_template('list.html', files=list)

@app.route('/download/<filename>', methods = ['GET'])
def download_file(filename):
 #  uploads = os.path.join(current_app.root_path, 'uploads')
   return send_from_directory(directory='./uploads/', filename=filename)
      
		
if __name__ == '__main__':
   app.run(debug = True)
